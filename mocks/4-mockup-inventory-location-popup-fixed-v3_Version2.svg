<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="900" viewBox="0 0 1200 900">
  <style>
    .bg{fill:#f6f8fb}
    .title{fill:#0f172a;font-family:Arial, sans-serif;font-size:20px;font-weight:700}
    .muted{fill:#59626a;font-family:Arial, sans-serif;font-size:13px}
    .card{fill:#ffffff;stroke:#e6e9ef;stroke-width:1;rx:8}
    .input{fill:#fbfdff;stroke:#e6e9ef;stroke-width:1;rx:6}
    .btn{fill:#0b74ff;rx:6}
    .btn-text{fill:#fff;font-family:Arial, sans-serif;font-size:13px;font-weight:700}
    .table-head{fill:#f8fafc;stroke:#e6e9ef}
    .row{fill:#ffffff;stroke:#eef2f6;rx:6}
    .cell{fill:#fff;stroke:#e6e9ef;rx:6}
    .small{font-family:Arial, sans-serif;font-size:12px;fill:#59626a}
    .sku{font-family:Arial, sans-serif;font-size:13px;fill:#0f172a;font-weight:600}
    .low{fill:#fff7ed;stroke:#ffedd5;rx:6}
    .icon{fill:#6b7280;font-family:Arial, sans-serif; font-size:14px}
    .overlay{fill:rgba(2,6,23,0.46)}
    .modal{fill:#fff;stroke:#e6e9ef;stroke-width:1;rx:10;filter:drop-shadow(0 6px 18px rgba(2,6,23,0.2))}
    .tab-active{fill:#0b74ff;fill-opacity:0.08}
    .tab{fill:#fff;stroke:#e6e9ef;rx:6}
    .highlight{stroke:#0b74ff;stroke-width:1.5;rx:6}
  </style>

  <rect width="1200" height="900" class="bg"/>

  <!-- Header / Controls -->
  <text x="40" y="44" class="title">Inventario</text>
  <text x="40" y="70" class="muted">Buscar por nombre, SKU o tags · Seleccionar ubicación para edición rápida</text>

  <g transform="translate(40,96)">
    <rect width="1120" height="60" class="card"/>
    <rect x="16" y="10" width="560" height="40" class="input"/>
    <text x="26" y="36" class="small">Buscar por nombre, SKU o tags...</text>
    <rect x="600" y="10" width="220" height="40" class="input"/>
    <text x="610" y="36" class="small">Ubicación: <tspan class="sku">WAREHOUSE</tspan> ▾</text>
    <rect x="840" y="10" width="120" height="40" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="868" y="36" class="small">Filtrar</text>
    <rect x="972" y="10" width="160" height="40" class="btn"><text x="1000" y="36" class="btn-text">Exportar CSV</text></rect>
  </g>

  <!-- Table header -->
  <g transform="translate(40,168)">
    <rect width="1120" height="44" class="table-head"/>
    <text x="20" y="28" class="small">Producto</text>
    <text x="300" y="28" class="small">Código</text>
    <text x="420" y="28" class="small">Stock (WAREHOUSE)</text>
    <text x="570" y="28" class="small">Variantes</text>
    <text x="900" y="28" class="small">SKU</text>
    <text x="1040" y="28" class="small">Detalle</text>
  </g>

  <!-- Row A: product without variants -->
  <g transform="translate(40,220)">
    <rect width="1120" height="68" class="row"/>
    <rect x="12" y="8" width="56" height="52" fill="#f3f4f6" stroke="#e6e9ef" rx="6"/>
    <text x="80" y="36" class="sku">Camisa Lavender</text>
    <text x="80" y="54" class="small">Remera premium · Proveedor: Textiles SA</text>
    <text x="300" y="38" class="small">CAM-LAV</text>

    <!-- stock for selected location -->
    <rect x="420" y="18" width="88" height="36" class="input"/><text x="452" y="44" class="small">10</text>

    <text x="570" y="38" class="small">—</text>
    <text x="900" y="38" class="small">CAM-LAV</text>

    <!-- detail icon -->
    <g transform="translate(1040,16)">
      <rect x="0" y="0" width="36" height="36" fill="#fff" stroke="#e6e9ef" rx="6"/>
      <text x="8" y="24" class="icon">⟳</text>
    </g>
  </g>

  <!-- Row B: product with variants (collapsed) -->
  <g transform="translate(40,296)">
    <rect width="1120" height="68" class="row"/>
    <rect x="12" y="8" width="56" height="52" fill="#f3f4f6" stroke="#e6e9ef" rx="6"/>
    <text x="80" y="36" class="sku">Body Brooklyn</text>
    <text x="80" y="54" class="small">Body algodón · Proveedor: Textiles SA</text>
    <text x="300" y="38" class="small">BODY-BRK</text>

    <!-- aggregated stock for selected location (sum of variants in warehouse) -->
    <rect x="420" y="18" width="88" height="36" class="input"/><text x="452" y="44" class="small">28</text>

    <g transform="translate(570,10)">
      <rect x="0" y="8" width="320" height="52" fill="#fff" stroke="#e6e9ef" rx="6"/>
      <text x="8" y="36" class="small">Colores: Blanco, Negro · Talles: S, M, L</text>
      <rect x="290" y="18" width="24" height="24" fill="#f3f4f6" stroke="#e6e9ef" rx="6"/><text x="295" y="36" class="small">▾</text>
    </g>

    <text x="900" y="38" class="small">—</text>

    <!-- detail icon (product-level) -->
    <g transform="translate(1040,16)">
      <rect x="0" y="0" width="36" height="36" fill="#fff" stroke="#e6e9ef" rx="6"/>
      <text x="8" y="24" class="icon">⟳</text>
    </g>
  </g>

  <!-- Expanded panel showing variants (showing only selected location stock) -->
  <g transform="translate(40,372)">
    <rect x="56" y="0" width="1044" height="160" fill="#ffffff" stroke="#eef2f6" rx="8"/>
    <text x="72" y="20" class="small">Variantes</text>

    <!-- Variant A (this is the variant for popup) -->
    <g transform="translate(72,32)">
      <text x="0" y="18" class="small">Negro / S</text>
      <text x="160" y="18" class="small">SKU: BODY-BLK-S</text>
      <!-- only WH shown because 'WAREHOUSE' is selected -->
      <text x="320" y="18" class="small">WH:</text><rect x="352" y="0" width="64" height="28" class="input"/><text x="372" y="18" class="small">20</text>
      <text x="760" y="18" class="small">Reserved: 2</text>
      <!-- highlight variant that will open popup -->
      <rect x="344" y="-4" width="76" height="36" fill="none" class="highlight"/>
      <!-- edit icon + detail icon (detail opens popup with per-location breakdown for this variant) -->
      <rect x="896" y="0" width="36" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="904" y="20" class="small">✎</text>
      <g transform="translate(940,-4)"><rect x="0" y="0" width="28" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="6" y="20" class="small">⟳</text></g>
    </g>

    <!-- Variant B -->
    <g transform="translate(72,64)">
      <text x="0" y="18" class="small">Blanco / M</text>
      <text x="160" y="18" class="small">SKU: BODY-WHT-M</text>
      <text x="320" y="18" class="small">WH:</text><rect x="352" y="0" width="64" height="28" class="input"/><text x="372" y="18" class="small">8</text>
      <text x="760" y="18" class="small">Reserved: 0</text>
      <rect x="896" y="0" width="36" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="904" y="20" class="small">✎</text>
      <g transform="translate(940,-4)"><rect x="0" y="0" width="28" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="6" y="20" class="small">⟳</text></g>
    </g>

    <!-- Variant C -->
    <g transform="translate(72,96)">
      <text x="0" y="18" class="small">Negro / M</text>
      <text x="160" y="18" class="small">SKU: BODY-BLK-M</text>
      <text x="320" y="18" class="small">WH:</text><rect x="352" y="0" width="64" height="28" class="input"/><text x="372" y="18" class="small">0</text>
      <text x="760" y="18" class="small">Reserved: 0</text>
      <rect x="896" y="0" width="36" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="904" y="20" class="small">✎</text>
      <g transform="translate(940,-4)"><rect x="0" y="0" width="28" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="6" y="20" class="small">⟳</text></g>
    </g>
  </g>

  <!-- Helper note -->
  <text x="40" y="548" class="small">Nota: la columna principal y las celdas inline muestran únicamente la ubicación seleccionada (aquí: WAREHOUSE). Usa el icono ⟳ junto a una variante para abrir el popup y ver/editar el desglose por todas las ubicaciones.</text>

  <!-- Popup overlay for variant "Negro / S" showing per-location detail (centered and visible) -->
  <g>
    <rect x="0" y="0" width="1200" height="900" class="overlay"/>
    <!-- Popup container centered vertically and horizontally -->
    <g transform="translate(120,220)">
      <rect width="960" height="360" class="modal"/>
      <text x="20" y="36" fill="#0f172a" font-family="Arial" font-size="16" font-weight="700">Detalle de stock — Body Brooklyn · Negro / S</text>
      <text x="20" y="60" class="small">SKU: BODY-BLK-S · Categoría: Bodys · Proveedor: Textiles SA</text>

      <!-- Tabs -->
      <g transform="translate(20,80)">
        <rect x="0" y="0" width="220" height="36" class="tab-active"/><text x="12" y="24" class="small" fill="#0b74ff">Ubicaciones</text>
        <rect x="240" y="0" width="220" height="36" class="tab"/><text x="252" y="24" class="small">Movimientos</text>
      </g>

      <!-- Locations table inside popup -->
      <g transform="translate(20,128)">
        <rect x="0" y="0" width="920" height="180" fill="#fff" stroke="#e6e9ef" rx="8"/>
        <!-- header -->
        <g transform="translate(12,12)">
          <rect x="0" y="0" width="880" height="36" class="table-head"/>
          <text x="12" y="24" class="small">Ubicación</text>
          <text x="240" y="24" class="small">Cantidad</text>
          <text x="360" y="24" class="small">Reservada</text>
          <text x="460" y="24" class="small">Disponible</text>
          <text x="580" y="24" class="small">Acciones</text>
        </g>

        <!-- rows -->
        <g transform="translate(12,52)">
          <rect x="0" y="0" width="880" height="36" class="cell"/><text x="12" y="24" class="small">WAREHOUSE — Almacén central</text>
          <rect x="240" y="4" width="120" height="28" class="input"/><text x="272" y="24" class="small">20</text>
          <text x="372" y="24" class="small">Reservada: 2</text>
          <text x="472" y="24" class="small">Disponible: 18</text>
          <g transform="translate(580,0)"><rect x="0" y="0" width="80" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="22" y="18" class="small">Ajustar</text></g>
        </g>

        <g transform="translate(12,92)">
          <rect x="0" y="0" width="880" height="36" class="cell"/><text x="12" y="24" class="small">STORE_A — Sucursal A</text>
          <rect x="240" y="4" width="120" height="28" class="input"/><text x="272" y="24" class="small">0</text>
          <text x="372" y="24" class="small">Reservada: 0</text>
          <text x="472" y="24" class="small">Disponible: 0</text>
          <g transform="translate(580,0)"><rect x="0" y="0" width="80" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="22" y="18" class="small">Ajustar</text></g>
        </g>

        <g transform="translate(12,132)">
          <rect x="0" y="0" width="880" height="36" class="cell"/><text x="12" y="24" class="small">STORE_B — Sucursal B</text>
          <rect x="240" y="4" width="120" height="28" class="input"/><text x="272" y="24" class="small">0</text>
          <text x="372" y="24" class="small">Reservada: 0</text>
          <text x="472" y="24" class="small">Disponible: 0</text>
          <g transform="translate(580,0)"><rect x="0" y="0" width="80" height="28" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="22" y="18" class="small">Ajustar</text></g>
        </g>
      </g>

      <!-- Popup footer -->
      <g transform="translate(20,316)">
        <rect x="0" y="0" width="120" height="30" fill="#fff" stroke="#e6e9ef" rx="6"/><text x="36" y="20" class="small">Cerrar</text>
        <rect x="760" y="0" width="180" height="30" class="btn" rx="6"/><text x="816" y="20" class="btn-text">Guardar cambios</text>
      </g>
    </g>
  </g>
</svg>